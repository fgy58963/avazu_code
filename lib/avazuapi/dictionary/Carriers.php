<?php 
	class Carriers {
		private static $isInit = FALSE;
		private static $jsonStr = '';
		private static $carriers = array();
		
		public static function getAllCarriers() {
			self::init();
			
			return self::$carriers;
		}
		
		public static function getCarrierssByCountryCode($codes, $include = TRUE) {
			$carriers = self::getAllCarriers();
			$result = array();
			
			foreach ($carriers as $countryCode => $car) {
				if (($include && in_array($countryCode, $codes)) || (!$include && !in_array($countryCode, $codes))) {
					$result[$countryCode] = $car;
				}
			}
			
			return $result;
		}
		
		public static function getCarriersById($id, $notFoundValue = 'Unknown') {
			$carriers = self::getAllCarriers();
			$result = array();
		
			foreach ($carriers as $c => $item) {
				foreach ($item['isps'] as $cs) {
					if ($cs['id'] == $id) {
						return $cs['name'] . '(' . $item['country'] . ')';
					}
				}
			}
		
			return $notFoundValue;
		}
		
		private static function init() {
			if (self::$isInit) {
				return;
			}
			/*
			self::$jsonStr = DictionaryCurl::get(API_CARRIERS_URL);

			if (empty(self::$jsonStr)) {
				self::$jsonStr = '{"from":"DB","code":0,"msg":"success","data":{"AR":{"country":"Argentina","isps":[{"id":100000,"subid":0,"name":"Claro"},{"id":100001,"subid":1,"name":"movistar"},{"id":100002,"subid":2,"name":"Personal"}]},"AU":{"country":"Australia","isps":[{"id":100003,"subid":0,"name":"Optus Mobile"},{"id":100004,"subid":1,"name":"Telstra"},{"id":100006,"subid":3,"name":"Three"},{"id":100007,"subid":4,"name":"Virgin"},{"id":100005,"subid":2,"name":"Vodafone"}]},"AT":{"country":"Austria","isps":[{"id":100008,"subid":0,"name":"A1"},{"id":100012,"subid":4,"name":"H3G"},{"id":100011,"subid":3,"name":"Mobilkom"},{"id":100009,"subid":1,"name":"Orange"},{"id":100010,"subid":2,"name":"T-Mobile"}]},"BH":{"country":"Bahrain","isps":[{"id":100013,"subid":0,"name":"Batelco"},{"id":100014,"subid":1,"name":"Zain"}]},"BE":{"country":"Belgium","isps":[{"id":100015,"subid":0,"name":"BASE"},{"id":100016,"subid":1,"name":"Mobistar"},{"id":100017,"subid":2,"name":"Proximus"}]},"BR":{"country":"Brazil","isps":[{"id":100018,"subid":0,"name":"Claro"},{"id":100019,"subid":1,"name":"Oi"},{"id":100020,"subid":2,"name":"TIM"},{"id":100021,"subid":3,"name":"Vivo"}]},"CA":{"country":"Canada","isps":[{"id":100022,"subid":0,"name":"Bell Canada"},{"id":100023,"subid":1,"name":"Mobilicity"},{"id":100024,"subid":2,"name":"MTS"},{"id":100025,"subid":3,"name":"Rogers"},{"id":100026,"subid":4,"name":"Telus"},{"id":100027,"subid":5,"name":"WIND"}]},"CL":{"country":"Chile","isps":[{"id":100028,"subid":0,"name":"Claro"},{"id":100029,"subid":1,"name":"Entel"},{"id":100030,"subid":2,"name":"movistar"}]},"CN":{"country":"China","isps":[{"id":100031,"subid":0,"name":"China Mobile"},{"id":100032,"subid":1,"name":"China Telecom"},{"id":100033,"subid":2,"name":"UNICOM"}]},"CO":{"country":"Colombia","isps":[{"id":100034,"subid":0,"name":"Claro\/Comcel"},{"id":100035,"subid":1,"name":"movistar"},{"id":100036,"subid":2,"name":"Tigo"}]},"CR":{"country":"Costa Rica","isps":[{"id":100037,"subid":0,"name":"ICE"}]},"CZ":{"country":"Czech Republic","isps":[{"id":100038,"subid":0,"name":"O2"},{"id":100039,"subid":1,"name":"T-Mobile"},{"id":100040,"subid":2,"name":"Vodafone"}]},"DK":{"country":"Denmark","isps":[{"id":100041,"subid":0,"name":"TDC"},{"id":100042,"subid":1,"name":"Telenor"},{"id":100043,"subid":2,"name":"Telia"}]},"DO":{"country":"Dominican Republic","isps":[{"id":100044,"subid":0,"name":"Claro"},{"id":100045,"subid":1,"name":"Orange"}]},"EC":{"country":"Ecuador","isps":[{"id":100046,"subid":0,"name":"Claro"},{"id":100047,"subid":1,"name":"movistar"}]},"EG":{"country":"Egypt","isps":[{"id":100048,"subid":0,"name":"Etisalat"},{"id":100049,"subid":1,"name":"Mobinil"},{"id":100050,"subid":2,"name":"Vodafone"}]},"SV":{"country":"El Salvador","isps":[{"id":100212,"subid":0,"name":"Claro"},{"id":100213,"subid":1,"name":"Digicel"},{"id":100214,"subid":2,"name":"Movistar"}]},"FI":{"country":"Finland","isps":[{"id":100051,"subid":0,"name":"DNA"},{"id":100052,"subid":1,"name":"Elisa"},{"id":100053,"subid":2,"name":"Sonera"}]},"FR":{"country":"France","isps":[{"id":100054,"subid":0,"name":"Bouygues Telecom"},{"id":100055,"subid":1,"name":"Free Mobile"},{"id":100056,"subid":2,"name":"Orange"},{"id":100057,"subid":3,"name":"SFR"}]},"DE":{"country":"Germany","isps":[{"id":100058,"subid":0,"name":"E-Plus"},{"id":100059,"subid":1,"name":"O2"},{"id":100060,"subid":2,"name":"T-Mobile"},{"id":100061,"subid":3,"name":"Vodafone"}]},"GR":{"country":"Greece","isps":[{"id":100062,"subid":0,"name":"Cosmote"},{"id":100063,"subid":1,"name":"Vodafone"},{"id":100064,"subid":2,"name":"WIND"}]},"GT":{"country":"Guatemala","isps":[{"id":100065,"subid":0,"name":"Claro"},{"id":100068,"subid":3,"name":"Comcel"},{"id":100066,"subid":1,"name":"movistar"},{"id":100067,"subid":2,"name":"Tigo"}]},"HK":{"country":"Hong Kong","isps":[{"id":100069,"subid":0,"name":"PCCW Mobile"},{"id":100070,"subid":1,"name":"SmarTone"}]},"HU":{"country":"Hungary","isps":[{"id":100071,"subid":0,"name":"Pannon"},{"id":100072,"subid":1,"name":"T-Mobile"},{"id":100073,"subid":2,"name":"Vodafone"}]},"IN":{"country":"India","isps":[{"id":100074,"subid":0,"name":"Aircel"},{"id":100075,"subid":1,"name":"Airtel"},{"id":100076,"subid":2,"name":"BSNL"},{"id":100077,"subid":3,"name":"IDEA"},{"id":100078,"subid":4,"name":"MTNL"},{"id":100079,"subid":5,"name":"Reliance"},{"id":100080,"subid":6,"name":"TATA DOCOMO"},{"id":100081,"subid":7,"name":"Vodafone"}]},"ID":{"country":"Indonesia","isps":[{"id":100082,"subid":0,"name":"Axis"},{"id":100083,"subid":1,"name":"Indosat"},{"id":100084,"subid":2,"name":"Telkomsel"},{"id":100085,"subid":3,"name":"XL"}]},"IE":{"country":"Ireland","isps":[{"id":100086,"subid":0,"name":"Meteor"},{"id":100087,"subid":1,"name":"O2"},{"id":100088,"subid":2,"name":"Vodafone"}]},"IL":{"country":"Israel","isps":[{"id":100089,"subid":0,"name":"Cellcom"},{"id":100090,"subid":1,"name":"Golan Telecom"},{"id":100091,"subid":2,"name":"Mirs"},{"id":100092,"subid":3,"name":"Orange"},{"id":100093,"subid":4,"name":"Pelephone"}]},"IT":{"country":"Italy","isps":[{"id":100094,"subid":0,"name":"TIM"},{"id":100095,"subid":1,"name":"Vodafone"},{"id":100096,"subid":2,"name":"WIND"}]},"JP":{"country":"Japan","isps":[{"id":100097,"subid":0,"name":"KDDI\/au"},{"id":100098,"subid":1,"name":"NTT DoCoMo"},{"id":100099,"subid":2,"name":"SoftBank"}]},"JO":{"country":"Jordan","isps":[{"id":100219,"subid":0,"name":"Asiacell"},{"id":100220,"subid":1,"name":"Orange Jordan"},{"id":100221,"subid":2,"name":"Umniah"},{"id":100222,"subid":3,"name":"XPress Telecom"},{"id":100223,"subid":4,"name":"Zain Jordan"}]},"KE":{"country":"Kenya","isps":[{"id":100100,"subid":0,"name":"Orange"},{"id":100101,"subid":1,"name":"Safaricom"}]},"KR":{"country":"Korea, Republic of","isps":[{"id":100157,"subid":0,"name":"KT"},{"id":100158,"subid":1,"name":"LGU"},{"id":100159,"subid":2,"name":"SKT"}]},"KW":{"country":"Kuwait","isps":[{"id":100102,"subid":0,"name":"Viva"},{"id":100103,"subid":1,"name":"Wataniya"},{"id":100104,"subid":2,"name":"Zain"}]},"MY":{"country":"Malaysia","isps":[{"id":100105,"subid":0,"name":"Celcom"},{"id":100106,"subid":1,"name":"DiGi"},{"id":100107,"subid":2,"name":"Maxis"}]},"MX":{"country":"Mexico","isps":[{"id":100108,"subid":0,"name":"Iusacell"},{"id":100109,"subid":1,"name":"movistar"},{"id":100110,"subid":2,"name":"Nextel"},{"id":100111,"subid":3,"name":"Telcel"}]},"NL":{"country":"Netherlands","isps":[{"id":100112,"subid":0,"name":"KPN"},{"id":100113,"subid":1,"name":"T-Mobile"},{"id":100114,"subid":2,"name":"Vodafone"}]},"NZ":{"country":"New Zealand","isps":[{"id":100115,"subid":0,"name":"2degrees"},{"id":100116,"subid":1,"name":"Telecom Xtra"},{"id":100117,"subid":2,"name":"Vodafone"}]},"NG":{"country":"Nigeria","isps":[{"id":100118,"subid":0,"name":"Glo Mobile"},{"id":100119,"subid":1,"name":"MTN"},{"id":100120,"subid":2,"name":"Starcomms"},{"id":100121,"subid":3,"name":"Visafone"}]},"NO":{"country":"Norway","isps":[{"id":100122,"subid":0,"name":"NetCom"},{"id":100123,"subid":1,"name":"Telenor"}]},"PA":{"country":"Panama","isps":[{"id":100125,"subid":1,"name":"CW"},{"id":100126,"subid":2,"name":"Digicel"},{"id":100124,"subid":0,"name":"Movil"}]},"PY":{"country":"Paraguay","isps":[{"id":100215,"subid":0,"name":"Claro"},{"id":100216,"subid":1,"name":"Personal"},{"id":100217,"subid":2,"name":"Tigo"},{"id":100218,"subid":3,"name":"Vox"}]},"PE":{"country":"Peru","isps":[{"id":100127,"subid":0,"name":"Claro"},{"id":100128,"subid":1,"name":"movistar"},{"id":100129,"subid":2,"name":"Nextel"}]},"PH":{"country":"Philippines","isps":[{"id":100130,"subid":0,"name":"Globe"},{"id":100131,"subid":1,"name":"Smart"}]},"PL":{"country":"Poland","isps":[{"id":100132,"subid":0,"name":"Era"},{"id":100133,"subid":1,"name":"Orange"},{"id":100134,"subid":2,"name":"Play"},{"id":100135,"subid":3,"name":"Plus"},{"id":100136,"subid":4,"name":"T-Mobile"}]},"PT":{"country":"Portugal","isps":[{"id":100137,"subid":0,"name":"Optimus"},{"id":100138,"subid":1,"name":"TMN"},{"id":100139,"subid":2,"name":"Vodafone"}]},"QA":{"country":"Qatar","isps":[{"id":100140,"subid":0,"name":"Qtel"},{"id":100141,"subid":1,"name":"Vodafone"}]},"RU":{"country":"Russian Federation","isps":[{"id":100142,"subid":0,"name":"Beeline"},{"id":100143,"subid":1,"name":"MegaFon"},{"id":100144,"subid":2,"name":"MTS"},{"id":100145,"subid":3,"name":"Tele 2"}]},"SA":{"country":"Saudi Arabia","isps":[{"id":100146,"subid":0,"name":"Al Jawal"},{"id":100147,"subid":1,"name":"Mobily"},{"id":100148,"subid":2,"name":"Zain"}]},"SG":{"country":"Singapore","isps":[{"id":100149,"subid":0,"name":"M1"},{"id":100150,"subid":1,"name":"SingTel"},{"id":100151,"subid":2,"name":"StarHub"}]},"SI":{"country":"Slovenia","isps":[{"id":100152,"subid":0,"name":"Mobitel"},{"id":100153,"subid":1,"name":"Tusmobil"}]},"ZA":{"country":"South Africa","isps":[{"id":100154,"subid":0,"name":"Cell C"},{"id":100155,"subid":1,"name":"MTN"},{"id":100156,"subid":2,"name":"VodaCom"}]},"ES":{"country":"Spain","isps":[{"id":100160,"subid":0,"name":"Orange"},{"id":100161,"subid":1,"name":"Telefonica\/Movistar"},{"id":100162,"subid":2,"name":"Vodafone"},{"id":100163,"subid":3,"name":"Yoigo"}]},"SE":{"country":"Sweden","isps":[{"id":100164,"subid":0,"name":"Tele 2"},{"id":100165,"subid":1,"name":"Telenor"},{"id":100166,"subid":2,"name":"Telia"}]},"CH":{"country":"Switzerland","isps":[{"id":100167,"subid":0,"name":"Orange"},{"id":100168,"subid":1,"name":"Sunrise"},{"id":100169,"subid":2,"name":"Swisscom"}]},"TW":{"country":"Taiwan","isps":[{"id":100170,"subid":0,"name":"Chunghwa Telecom"},{"id":100171,"subid":1,"name":"Far EasTone"},{"id":100172,"subid":2,"name":"Taiwan Mobile"}]},"TZ":{"country":"Tanzania, United Republic of","isps":[{"id":100173,"subid":0,"name":"VodaCom"},{"id":100174,"subid":1,"name":"Zain"},{"id":100175,"subid":2,"name":"Zantel"}]},"TH":{"country":"Thailand","isps":[{"id":100176,"subid":0,"name":"AIS"},{"id":100177,"subid":1,"name":"dtac"},{"id":100178,"subid":2,"name":"Hutch"},{"id":100179,"subid":3,"name":"True Move"}]},"TR":{"country":"Turkey","isps":[{"id":100180,"subid":0,"name":"Avea"},{"id":100181,"subid":1,"name":"Turkcell"},{"id":100182,"subid":2,"name":"Vodafone"}]},"UA":{"country":"Ukraine","isps":[{"id":100183,"subid":0,"name":"Kyivstar"},{"id":100184,"subid":1,"name":"life:)"},{"id":100185,"subid":2,"name":"MTS"},{"id":100186,"subid":3,"name":"Utel"}]},"AE":{"country":"United Arab Emirates","isps":[{"id":100187,"subid":0,"name":"du"},{"id":100188,"subid":1,"name":"Etisalat"}]},"GB":{"country":"United Kingdom","isps":[{"id":100189,"subid":0,"name":"O2"},{"id":100190,"subid":1,"name":"Orange"},{"id":100191,"subid":2,"name":"T-Mobile"},{"id":100193,"subid":4,"name":"Three"},{"id":100192,"subid":3,"name":"Vodafone"}]},"US":{"country":"United States","isps":[{"id":100194,"subid":0,"name":"AT&T"},{"id":100196,"subid":2,"name":"C Spire"},{"id":100195,"subid":1,"name":"Cricket Communications"},{"id":100197,"subid":3,"name":"Metro PCS"},{"id":100198,"subid":4,"name":"Nextel"},{"id":100199,"subid":5,"name":"Sprint"},{"id":100200,"subid":6,"name":"T-Mobile"},{"id":100201,"subid":7,"name":"US Cellular"},{"id":100202,"subid":8,"name":"Verizon"},{"id":100203,"subid":9,"name":"Virgin Mobile"}]},"UY":{"country":"Uruguay","isps":[{"id":100204,"subid":0,"name":"Ancel"}]},"VE":{"country":"Venezuela","isps":[{"id":100205,"subid":0,"name":"Digitel"},{"id":100206,"subid":1,"name":"Movilnet"},{"id":100207,"subid":2,"name":"movistar"}]},"VN":{"country":"Vietnam","isps":[{"id":100208,"subid":0,"name":"Beeline"},{"id":100209,"subid":1,"name":"MobiFone"},{"id":100210,"subid":2,"name":"Vietel"},{"id":100211,"subid":3,"name":"Vinaphone"}]}}}';
			} 
			
			$tmp = json_decode(self::$jsonStr, TRUE);
			*/
            $data = Cache_MemcachedSource::sGet('get_carrier_json');
            if(!empty($data)){
                $data = json_decode($data,TRUE);
            }else{
                $data = F::$f->Ad_Model_CarrierCountryContact->getCarrierJson();
                Cache_MemcachedSource::sSet('get_carrier_json',json_encode($data),86400);
            }
            self::$carriers = $data;
			self::$isInit = TRUE;
		}
	}
?>